typedef struct {
    int64_t bid;
    int64_t ask;
} PriceBook;
/*it parses messages directly into the buffer, it doesn't allocate memory, it reads characters by subtracting the pointer, use strchr to find the delimiter soh outputs a pointer, the idea is to get information by 
identifying length of characters, a custom function that turns a string into a fixed point integer. */
void parse_market_data(char *msg, int len, PriceBook *book) {
    char *ptr = msg; //This is your "Scout." It starts at the beginning of the message and will move forward byte-by-byte.
    char *end = msg + len;
    int current_type = -1; // 0 for Bid, 1 for Ask A simple flag. In FIX, prices come after the type, so we need to remember if we are currently looking at a Bid or an Ask.

    while (ptr < end) {
        // Find the next tag (e.g., "269=")
        if (memcmp(ptr, "269=", 4) == 0) {    // Checks if the current 4 bytes are exactly "269="
            current_type = *(ptr + 4) - '0'; // Quick char-to-int for '0' or '1'
        } 
        else if (memcmp(ptr, "270=", 4) == 0) {  //This tag defines the MDEntryPx (The actual price)
            ptr += 4; // Move to the start of the price string Instead of calling a heavy conversion function, it takes the character at position 4 (like '0') and subtracts the ASCII value of '0'.
            
            // Find the end of the price (the SOH separator) In FIX, fields are separated by the Start of Header character (0x01).
            char *next_soh = strchr(ptr, SOH); //strchr: Finds the next 0x01 in memory.
            int val_len = (int)(next_soh - ptr); //val_len: Calculated by subtracting the pointers. This tells us exactly how many bytes the price string occupies (e.g., "150.55" is 6 bytes).
            
            // Convert to fixed-point integer
            int64_t price_val = fast_price_to_int(ptr, val_len); //A custom function (likely 64-bit) that turns a string like "150.55" into a fixed-point integer like 1505500. This avoids floating-point math errors.
            
            if (current_type == 0) book->bid = price_val;
            else if (current_type == 1) book->ask = price_val; //Depending on our current_type flag, we save the value into the PriceBook struct.
            
            ptr = next_soh; // Jump to the separator //We move our scout ptr directly to the next_soh to skip the rest of the price digits.
        }
        ptr++; // Keep scanning
    }
}
